# 네이버 판매자 정보 수집기

네이버 스마트스토어의 판매자 정보를 자동으로 수집하고 엑셀에 업데이트하는 도구입니다.

## 📁 파일 구조

```
├── main.py              # 메인 실행 파일
├── config.py            # 설정 및 상수
├── excel_handler.py     # 엑셀 파일 처리
├── browser_handler.py   # 브라우저 제어 및 스크래핑
├── collector.py         # 메인 수집기 클래스
├── requirements.txt     # 필요한 라이브러리
├── sellers_250711.xlsx  # 판매자 데이터 파일
└── README.md           # 사용 가이드
```

## 🚀 설치 및 실행

### 1. 라이브러리 설치
```bash
pip install -r requirements.txt
```

### 2. 엑셀 파일 준비
- `sellers_250711.xlsx` 파일을 동일 폴더에 위치
- 파일명이 다른 경우 `config.py`에서 `EXCEL_FILE_PATH` 수정

### 3. 실행
```bash
python main.py
```

## 🔧 주요 기능

### ✅ **자동 처리**
- 엑셀 파일에서 네이버 스마트스토어 URL만 자동 필터링
- 아래에서 위로 순차 처리 (역순)
- 이미 최신화된 항목은 자동 건너뜀
- 판매자 정보 자동 추출 (상호명, 전화번호, 이메일 등)

### 🔍 **캡차 처리**
- 캡차 자동 감지
- 사용자가 캡차를 풀면 자동으로 다음 단계 진행

### 💾 **실시간 저장**
- 각 스토어 처리 완료시 즉시 엑셀 파일 저장
- 중단되어도 이미 처리된 데이터는 보존

### ⚠️ **에러 처리**
- 접근 불가능한 스토어 자동 감지
- 판매자 정보 버튼이 없는 스토어 처리
- 에러 정보를 엑셀에 자동 기록

## 📋 실행 예시

```
🚀 네이버 판매자 정보 수집 시작
📋 처리 방식: 아래에서 위로 (역순)
⏭️ 이미 최신화된 항목은 자동 건너뜀
============================================================
엑셀 파일 로드 완료: 10217개 행
전체 네이버 스토어: 150개
이미 최신화 완료: 45개 (건너뜀)
처리할 네이버 스토어: 105개 (아래에서 위로)

📍 스토어 처리 중: 토션플러스 (1/105)
📊 엑셀 행 번호: 10217
🔗 URL: https://naver.me/fvqbd0a7

==================================================
🔍 캡차가 나타났습니다!
캡차를 풀어주세요.
==================================================
캡차를 다 풀었으면 Enter를 눌러주세요...

✅ 정보 추출 완료:
   전화번호: 010-5638-5664
   이메일: hjofzion1214@gmail.com
💾 엑셀 즉시 저장 완료: sellers_250711.xlsx

📍 스토어 처리 중: 슈리오 (2/105)
📊 엑셀 행 번호: 10216
🔗 URL: www.shoerio.com
⚠️ 페이지 접근 불가: 404

📍 스토어 처리 중: 런던부티끄 (3/105)
...
```

## ⚙️ 설정 변경

### `config.py`에서 설정 가능한 항목들:

```python
# 파일 경로
EXCEL_FILE_PATH = "sellers_250711.xlsx"

# 브라우저 대기 시간 (초)
BROWSER_WAIT_TIME = 10
PAGE_LOAD_DELAY = 2
INTER_STORE_DELAY = 2

# 엑셀 컬럼명
COLUMNS = {
    'COMPANY_NAME': '입점사명',
    'STORE_URL': '온라인 쇼핑몰 URL',
    'UPDATED_PHONE': '최신화 전화번호',
    'UPDATED_EMAIL': '최신화 이메일'
}
```

## 🛠️ 모듈별 기능

### `excel_handler.py`
- 엑셀 파일 로드 및 저장
- 네이버 스토어 필터링
- 판매자 정보 업데이트
- 에러 로그 기록

### `browser_handler.py`
- Undetected Chrome 드라이버 제어
- 페이지 접근성 체크
- 캡차 감지 및 대기
- 판매자 정보 추출

### `collector.py`
- 전체 프로세스 관리
- 스토어별 처리 로직
- 진행상황 출력

## 🚨 주의사항

1. **Chrome 브라우저 필요**: 시스템에 Chrome이 설치되어 있어야 합니다.

2. **네트워크 연결**: 안정적인 인터넷 연결이 필요합니다.

3. **캡차 처리**: 각 스토어마다 캡차가 나타날 수 있으므로 수동으로 풀어주어야 합니다.

4. **파일 권한**: 엑셀 파일이 다른 프로그램에서 열려있지 않은지 확인하세요.

5. **서버 부하**: 각 요청 사이에 2초 딜레이가 있습니다. (서버 부하 방지)

## 🔄 중단 및 재시작

- **중단**: `Ctrl+C`로 언제든 안전하게 중단 가능
- **재시작**: 이미 처리된 항목은 자동으로 건너뛰므로 언제든 재시작 가능

## 📊 결과 확인

처리 완료 후 엑셀 파일에서 다음 컬럼들이 업데이트됩니다:
- `최신화 전화번호`: 추출된 전화번호 또는 에러 메시지
- `최신화 이메일`: 추출된 이메일 주소

## ❓ 문제 해결

### Chrome 드라이버 오류
```bash
# 수동으로 Chrome 드라이버 재설치
pip uninstall undetected-chromedriver
pip install undetected-chromedriver
```

### 엑셀 파일 오류
- 파일이 다른 프로그램에서 열려있는지 확인
- 파일 권한 확인
- 백업 파일로 복원

### 캡차가 계속 나타나는 경우
- 브라우저를 완전히 닫고 재시작
- VPN 사용시 해제 후 시도
- 잠시 대기 후 재시도